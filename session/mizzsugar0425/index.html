<!DOCTYPE html>
<html lang="ja">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- OGP -->
  

  <title>PyCon mini Shizuoka - unittest.mockを使ってテストを書こう 〜モックオブジェクトを使ってより単体テストの目的に沿ったテストに〜</title>

  <link rel="stylesheet" href="/theme/css/main.css" />

  <!-- Bootstrap core CSS -->
  <link href="/theme/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- todo: add ud font? -->

  <!-- Custom fonts for this template -->
  <link href="/theme/vendor/fontawesome-free/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet'
    type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700' rel='stylesheet' type='text/css'>

  <!-- Custom styles for this template -->
  <link href="/theme/css_mod/agency.css" rel="stylesheet">

  <!-- using maru gotic -->
  <link href="https://fonts.googleapis.com/css?family=Kosugi+Maru&display=swap" rel="stylesheet">

  <link href="/theme/css_mod/pycon-mini-shizu-main.css" rel="stylesheet">

</head>

<body id="page-top">
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand js-scroll-trigger" href="/#page-top">PyCon mini Shizuoka
</a>
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
        data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
        aria-label="Toggle navigation">
        Menu
        <i class="fas fa-bars"></i>
      </button>

      <div class="collapse navbar-collapse" id="navbarResponsive">
      
        <ul class="navbar-nav text-uppercase ml-auto">

                <li class="active nav-item">
                  <a class="nav-link js-scroll-trigger"  href="/important_notices/">重要なお知らせ</a>
                </li>

              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  イベント情報
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="/#keynote">キーノート</a>
                  <a class="dropdown-item" href="/#guest_session">招待スピーカー</a>
                  <a class="dropdown-item" href="/category/session/">セッション一覧</a>
                  <a class="dropdown-item" href="/timetable/">タイムテーブル</a>
                </div>
              </li>

                <li class="active nav-item">
                  <a class="nav-link js-scroll-trigger"  href="/#access">会場</a>
                </li>

                <li class="active nav-item">
                  <a class="nav-link js-scroll-trigger"  href="/staff/">スタッフ</a>
                </li>

                <li class="active nav-item">
                  <a class="nav-link js-scroll-trigger"  href="/code-of-conduct/">行動規範</a>
                </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Header -->
<header class="other">
  <div class="container">
    <div class="intro-text">
    </div>
  </div>
</header>


<!-- セッション詳細用のテンプレ先 -->

<section id="content" class="page-section">
  <article>
    <div class="container">
      <h1 class="page-description">セッション詳細</h1>
      <div class="session-body">
        <header>
          <h1 class="session-title">unittest.mockを使ってテストを書こう 〜モックオブジェクトを使ってより単体テストの目的に沿ったテストに〜</h1>
        </header>
        <div class="row">
          <div class="col-md-4">
            <address class="speaker-name">
              <p>
                By: みずき
              </p>
            </address>
            <div class="speaker-info">
              <p class="speaker-self_intro">                昼間はデータマネジメントをしていますが、夜と休日はPythonでWEB開発しています。運用業務に携わってから開発者になった経験から、ずっとテストに関心があります。
              </p>
              
              <div class="speaker-network">
                <!-- twitter icon -->
                <a class="session-icon-link" href="https://twitter.com/mizzsugar0425"><i class="fab fa-twitter"></i></a> 

                <!-- github icon -->

                <!-- website -->
              </div>
            </div>
<p class="session-attr">
    <!-- <span class="attr-badge badge badge-info">セッション番号:12</span> -->
    <span class="attr-badge badge badge-info">レベル:Advanced: 経験者向け</span>
    <span class="attr-badge badge badge-info">カテゴリ:プログラミングノウハウ</span>
</p>          </div>
          <div class="col-md-8">
            <div class="session-content">
              <p>単体テストを書く上で、モックオブジェクトという手法があります。モックオブジェクトがどんな役割を果たすか、どのように使うかを知っていると、外部的な要因でテストが落ちなくなったり、テストしたいところだけテストできるようになって便利です。このトークでは、Pythonの標準モジュールunittest.mockを使ってモックオブジェクトを扱う方法について話します。</p>
<h3>対象となる人：</h3>
<ul>
<li>unittest.mockの存在は知っているけれどもイマイチ使いどころが分かっていない人</li>
<li>assertTrueやassertEqualなどの基本的なテストコードの文法は知っているけれど、何のためにテストを書くかをじっくり考えたことがない人</li>
</ul>
<p>※基本的なテストコードの文法や使い方を手短に説明します。単体テストを書いたことがなくてもこの話を聞けるように配慮します。</p>
<h3>トークの目的：</h3>
<ul>
<li>「なんとなくテスト書いた方がいい」から目的を持ったテストを書くように意識づける</li>
<li>単体テストを書く目的を達成するためにモックを使うべき場面で使えるようになる</li>
<li>unittest.mockの使い方/ハマりポイントの対応策を知ってもらう</li>
</ul>
<h3>話さないこと</h3>
<ul>
<li>テスト実行に便利なツールの紹介(coverageなど)</li>
<li>pytestの紹介及びunittestとの比較</li>
<li>E2Eテスト、結合テストの話</li>
</ul>
<h3>話すこと</h3>
<h4>単体テストの目的(3-5分)</h4>
<ul>
<li>単体テストの目的</li>
<li>単体テストを書くメリット</li>
<li>単体テストを書いて修正や機能追加をした例。(飲食店での購入合計金額を算出する関数を例に。既存の消費税が1.08に統一されていた頃の関数から軽減税率導入後の関数に変更する例を使います)<ul>
<li>assertEqualやassertTrueなどの基本的なアサーションメソッドの文法</li>
<li>テストを実行するコマンド</li>
<li>テストが落ちてからテストを通す道程</li>
<li>テストを書くとどこまで関数の振る舞いを保証しているかわかるというメリット</li>
</ul>
</li>
</ul>
<h4>単体テストでモックオブジェクトを使う理由(5-8分)</h4>
<ul>
<li>
<p>モックオブジェクトの説明</p>
</li>
<li>
<p>単体テストは下記の条件が揃っているべきである</p>
<ul>
<li>速く実行される</li>
<li>常に同じ条件下で同じことがテストされる</li>
<li>外的要因を排除する</li>
<li>1つのテストメソッドで1つのことのみ確認でないとならない</li>
<li>テスト対象の関数の振る舞いを担保する</li>
</ul>
</li>
<li>
<p>単体テストでモックオブジェクトを使うメリット</p>
</li>
</ul>
<h4>Pythonのunittest.mockの基本的な使い方(5-8分)</h4>
<ul>
<li>簡単なサンプルコードを使って説明(ランダムに運勢が出力されるおみくじを表現する関数を例に)<ul>
<li>unittest.mockを使わないテストコードで失敗する例</li>
<li>unittest.mockの基本的な文法</li>
<li>どのような考え方でこの例ではunittest.mockを使ったのか</li>
</ul>
</li>
</ul>
<p>unittest.mockモジュールを使って困った点とその対策(5-8分)</p>
<ul>
<li>unittest.mock.patchが当たらない</li>
<li>assert_called_onceなど、関数が呼ばれたことをアサートする方法</li>
<li>APIのレスポンスをモックすることで、(外部)APIを呼び出す関数の振る舞いをテストする</li>
<li>datetime.datetime.nowをモックオブジェクトに置き換えられない場合datetime.datetime.nowを引数に持たせるかPythonの3rdパーティライブラリ「freezegun」を使ってテストする</li>
</ul>
<hr>
            </div><!-- /.session-content -->
          </div>
        </div>
      </div>
    </div>
  </article>
</section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="row align-items-center">
        <div class="col-md-3">
        </div>
        <div class="col-md-6">
          <span class="copyright">Copyright &copy; PyCon mini Shizuoka 実行委員会</span>
          <p>お問合せ先: shizuoka at pycon.jp <br>(atをアットマークに変更してメールアドレスとして利用ください）</p>
        </div>
        <div class="col-md-3">
          <ul class="list-inline quicklinks">
            <li class="list-inline-item">
              Powered by <a href="http://getpelican.com/">Pelican</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </footer>


  <!-- Bootstrap core JavaScript -->
  <script src="/theme/vendor/jquery/jquery.min.js"></script>
  <script src="/theme/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Plugin JavaScript -->
  <script src="/theme/vendor/jquery-easing/jquery.easing.min.js"></script>

  <!-- Contact form JavaScript -->
  <script src="/theme/js/jqBootstrapValidation.js"></script>
  <script src="/theme/js/contact_me.js"></script>

  <!-- Custom scripts for this template -->
  <script src="/theme/js/agency.min.js"></script>

</body>

</html>